--
-- PostgreSQL database dump
--

-- Dumped from database version 16.9 (Ubuntu 16.9-0ubuntu0.24.04.1)
-- Dumped by pg_dump version 16.9 (Ubuntu 16.9-0ubuntu0.24.04.1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: actualizar_estado_order(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.actualizar_estado_order() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    -- Cuando se genera una factura, marcamos la orden como facturada
    UPDATE public."order"
    SET estado_order = 'FACTURADA'
    WHERE id_order = NEW.id_order;

    RETURN NEW;
END;
$$;


ALTER FUNCTION public.actualizar_estado_order() OWNER TO postgres;

--
-- Name: insert_sales_order(bigint, numeric, date, jsonb, bigint); Type: PROCEDURE; Schema: public; Owner: postgres
--

CREATE PROCEDURE public.insert_sales_order(IN p_id_contacto bigint, IN p_numero_order numeric, IN p_fecha_expedicion date, IN p_items jsonb, IN p_idcondicion_pago bigint)
    LANGUAGE plpgsql
    AS $$
DECLARE
    v_order_id bigint;
    v_item record;
BEGIN
    -- Insert into order table
    INSERT INTO public."order" (id_contacto, numero_order, fecha_expedicion, idcondicion_pago)
    VALUES (p_id_contacto, p_numero_order, p_fecha_expedicion, p_idcondicion_pago)
    RETURNING id_order INTO v_order_id;

    -- Loop through items in the JSON array and insert into order_detail
    FOR v_item IN SELECT * FROM jsonb_to_recordset(p_items) AS x(id_item bigint, cantidad integer)
    LOOP
        INSERT INTO public.order_detail (id_item, id_order, cantidad)
        VALUES (v_item.id_item, v_order_id, v_item.cantidad);
    END LOOP;

EXCEPTION
    WHEN OTHERS THEN
        RAISE EXCEPTION 'Error inserting sales order: %', SQLERRM;
END;
$$;


ALTER PROCEDURE public.insert_sales_order(IN p_id_contacto bigint, IN p_numero_order numeric, IN p_fecha_expedicion date, IN p_items jsonb, IN p_idcondicion_pago bigint) OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: condicion_pagos; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.condicion_pagos (
    idcondicion_pago bigint NOT NULL,
    describe_condicion character varying(45)
);


ALTER TABLE public.condicion_pagos OWNER TO postgres;

--
-- Name: condicion_pagos_idcondicion_pago_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.condicion_pagos_idcondicion_pago_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.condicion_pagos_idcondicion_pago_seq OWNER TO postgres;

--
-- Name: condicion_pagos_idcondicion_pago_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.condicion_pagos_idcondicion_pago_seq OWNED BY public.condicion_pagos.idcondicion_pago;


--
-- Name: contacto_cli; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.contacto_cli (
    id_contacto bigint NOT NULL,
    razon_social character varying(255),
    ruc_ci character varying(50),
    telefono_cto character varying(50),
    direccion_cto character varying(255)
);


ALTER TABLE public.contacto_cli OWNER TO postgres;

--
-- Name: contacto_cli_id_contacto_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.contacto_cli ALTER COLUMN id_contacto ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.contacto_cli_id_contacto_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: establecimiento; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.establecimiento (
    id_establecimiento bigint NOT NULL,
    razon_social character varying(250),
    ubicacion character varying(250),
    telefono character varying(25),
    numero_establecimiento character varying(5)
);


ALTER TABLE public.establecimiento OWNER TO postgres;

--
-- Name: establecimiento_id_establecimiento_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.establecimiento ALTER COLUMN id_establecimiento ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.establecimiento_id_establecimiento_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: factura_detalle; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.factura_detalle (
    id_factura_detail bigint NOT NULL,
    id_factura_enca bigint,
    cantidad numeric(20,0),
    unit_price numeric(20,0),
    total numeric(20,0) GENERATED ALWAYS AS ((cantidad * unit_price)) STORED,
    id_item bigint
);


ALTER TABLE public.factura_detalle OWNER TO postgres;

--
-- Name: factura_detalle_id_factura_detail_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.factura_detalle ALTER COLUMN id_factura_detail ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.factura_detalle_id_factura_detail_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: factura_encabezado; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.factura_encabezado (
    id_factura_enca bigint NOT NULL,
    numero_factura character varying(25),
    fecha_emision date,
    id_contacto bigint,
    idcondicion_pago bigint,
    id_punto_expedicion bigint,
    id_timbrado bigint,
    id_establecimiento bigint,
    id_order bigint
);


ALTER TABLE public.factura_encabezado OWNER TO postgres;

--
-- Name: item; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.item (
    id_item bigint NOT NULL,
    cod_item character varying(50),
    descripcion_item character varying(255) NOT NULL,
    precio_unitario numeric(45,0) DEFAULT 15 NOT NULL,
    item_activo boolean,
    id_marcas bigint NOT NULL,
    id_impuesto bigint NOT NULL,
    id_categoria bigint NOT NULL,
    cantidad_inicial numeric(45,0) NOT NULL
);


ALTER TABLE public.item OWNER TO postgres;

--
-- Name: item_categoria; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.item_categoria (
    id_categoria bigint NOT NULL,
    describe_categoria character varying(255) NOT NULL
);


ALTER TABLE public.item_categoria OWNER TO postgres;

--
-- Name: item_categoria_id_categoria_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.item_categoria ALTER COLUMN id_categoria ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.item_categoria_id_categoria_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: item_id_item_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.item ALTER COLUMN id_item ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.item_id_item_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: item_impuesto; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.item_impuesto (
    id_impuesto bigint NOT NULL,
    porcentaje_iva numeric DEFAULT 10 NOT NULL
);


ALTER TABLE public.item_impuesto OWNER TO postgres;

--
-- Name: item_impuesto_id_impuesto_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.item_impuesto ALTER COLUMN id_impuesto ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.item_impuesto_id_impuesto_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: item_marcas; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.item_marcas (
    id_marcas bigint NOT NULL,
    descripcion_marcas character varying(255) NOT NULL
);


ALTER TABLE public.item_marcas OWNER TO postgres;

--
-- Name: item_marcas_id_marcas_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.item_marcas ALTER COLUMN id_marcas ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.item_marcas_id_marcas_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: order; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public."order" (
    id_order bigint NOT NULL,
    id_contacto bigint NOT NULL,
    numero_order numeric(45,0) NOT NULL,
    fecha_expedicion date NOT NULL,
    idcondicion_pago integer,
    estado_order character varying(20) DEFAULT 'PENDIENTE'::character varying,
    CONSTRAINT chk_estado_order CHECK (((estado_order)::text = ANY ((ARRAY['PENDIENTE'::character varying, 'FACTURADA'::character varying, 'CADUCADA'::character varying])::text[])))
);


ALTER TABLE public."order" OWNER TO postgres;

--
-- Name: order_detail; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.order_detail (
    id_order_detail bigint NOT NULL,
    id_item bigint NOT NULL,
    id_order bigint NOT NULL,
    cantidad numeric(15,0)
);


ALTER TABLE public.order_detail OWNER TO postgres;

--
-- Name: order_detail_id_order_detail_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.order_detail ALTER COLUMN id_order_detail ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.order_detail_id_order_detail_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: order_id_order_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public."order" ALTER COLUMN id_order ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.order_id_order_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: punto_expedicion; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.punto_expedicion (
    id_punto_expedicion bigint NOT NULL,
    id_establecimiento bigint NOT NULL,
    numero_expedicion character varying(5)
);


ALTER TABLE public.punto_expedicion OWNER TO postgres;

--
-- Name: punto_expedicion_id_punto_expedicion_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.punto_expedicion ALTER COLUMN id_punto_expedicion ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.punto_expedicion_id_punto_expedicion_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: timbrado; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.timbrado (
    id_timbrado bigint NOT NULL,
    numero_autorizacion numeric(20,0),
    fecha_autorizacion date,
    fecha_inicio_vigencia date,
    estado_timbrado boolean,
    id_establecimiento bigint NOT NULL,
    id_punto_expedicion bigint NOT NULL
);


ALTER TABLE public.timbrado OWNER TO postgres;

--
-- Name: timbrado_id_timbrado_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.timbrado ALTER COLUMN id_timbrado ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.timbrado_id_timbrado_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: condicion_pagos idcondicion_pago; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.condicion_pagos ALTER COLUMN idcondicion_pago SET DEFAULT nextval('public.condicion_pagos_idcondicion_pago_seq'::regclass);


--
-- Data for Name: condicion_pagos; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.condicion_pagos (idcondicion_pago, describe_condicion) FROM stdin;
1	CONTADO
\.


--
-- Data for Name: contacto_cli; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.contacto_cli (id_contacto, razon_social, ruc_ci, telefono_cto, direccion_cto) FROM stdin;
2	ENANITOS VERDES SRL	008-000-888	+(5959)996-444-444	ACA CERQUITA NOMAS
1	OCACIONAL 	000-000	(XXXX)-XXX-XXX	SIN ESPECIFICAR
3	PITO PAEZ CC	7890000	CHIMBO	ALQILER
\.


--
-- Data for Name: establecimiento; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.establecimiento (id_establecimiento, razon_social, ubicacion, telefono, numero_establecimiento) FROM stdin;
1	COOP FRAM	FRAM	NO POSEE	001
\.


--
-- Data for Name: factura_detalle; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.factura_detalle (id_factura_detail, id_factura_enca, cantidad, unit_price, id_item) FROM stdin;
1	6	2	1000	1
2	6	1	1500	1
3	7	2	1000	1
4	7	1	1500	1
5	8	2	1000	1
6	8	1	1500	1
7	9	2	1000	1
8	9	1	1500	1
9	10	2	1000	1
10	10	1	1500	1
11	11	2	1000	1
12	11	1	1500	1
13	12	2	1000	1
14	12	1	1500	2
15	13	2	1000	1
16	13	1	1500	2
18	15	1	100	1
19	16	3	55000	2
20	16	1	100	1
21	17	1	100	1
22	18	1	100	1
23	19	1	100	1
24	20	1	100	1
25	21	1	100	1
26	22	1	100	1
27	23	1	100	1
28	24	1	55000	2
29	25	1000	15000	10
\.


--
-- Data for Name: factura_encabezado; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.factura_encabezado (id_factura_enca, numero_factura, fecha_emision, id_contacto, idcondicion_pago, id_punto_expedicion, id_timbrado, id_establecimiento, id_order) FROM stdin;
1	1-1-0000001	2025-04-30	1	1	1	1	1	1
2	1-1-0000002	2025-04-30	1	1	1	1	1	1
3	1-1-0000003	2025-04-30	1	1	1	1	1	1
4	1-1-0000004	2025-04-30	1	1	1	1	1	1
5	1-1-0000005	2025-04-30	1	1	1	1	1	1
6	1-1-0000006	2025-04-30	1	1	1	1	1	1
7	1-1-0000007	2025-04-30	1	1	1	1	1	1
8	1-1-0000008	2025-04-30	1	1	1	1	1	1
9	001-001-0000009	2025-04-30	1	1	1	1	1	1
10	001-001-0000010	2025-05-01	1	1	1	1	1	1
11	001-001-0000011	2025-05-01	1	1	1	1	1	1
12	001-001-0000012	2025-05-01	1	1	1	1	1	1
13	001-001-0000013	2025-05-01	1	1	1	1	1	1
14	001-001-0000014	2025-05-02	2	1	1	1	1	3
15	001-001-0000015	2025-05-02	2	1	1	1	1	3
16	001-001-0000016	2025-05-02	1	1	1	1	1	6
17	001-001-0000017	2025-05-02	2	1	1	1	1	3
18	001-001-0000018	2025-05-02	2	1	1	1	1	3
19	001-001-0000019	2025-05-03	2	1	1	1	1	3
20	001-001-0000020	2025-05-03	2	1	1	1	1	3
21	001-001-0000021	2025-05-03	2	1	1	1	1	3
22	001-001-0000022	2025-05-03	2	1	1	1	1	3
23	001-001-0000023	2025-05-05	1	1	1	1	1	1
24	001-001-0000024	2025-05-09	2	1	1	1	1	69
25	001-001-0000025	2025-05-21	1	1	1	1	1	77
\.


--
-- Data for Name: item; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.item (id_item, cod_item, descripcion_item, precio_unitario, item_activo, id_marcas, id_impuesto, id_categoria, cantidad_inicial) FROM stdin;
1	001	Coca Cola 2L	7500	t	1	2	1	50
2	002	CORONA 900ML SIN ALCHOL	55000	t	1	2	1	100
4	003	Coca Cola 2L	7500	t	1	2	1	50
10	005	forro para pepinos	15000	t	1	2	1	10
11	006	BOLSA PALSTICO	100	t	1	1	1	1000
13	008	PEDIDO DE AUXILIO	25000	t	1	2	1	100
9	004	PRUEBA UNITARIO	15000	t	1	3	1	100
14	009	CAHA FORTN ETTIQUETA NEGRA	21999	t	1	2	1	1000
12	007	FERNET BRANCA 900ML	25000	t	1	2	1	30
15	010	ANTIDEPRECIBO	150000	t	2	1	1	1
\.


--
-- Data for Name: item_categoria; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.item_categoria (id_categoria, describe_categoria) FROM stdin;
1	SIN ESPECIFICAR
\.


--
-- Data for Name: item_impuesto; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.item_impuesto (id_impuesto, porcentaje_iva) FROM stdin;
1	10
2	5
3	0
\.


--
-- Data for Name: item_marcas; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.item_marcas (id_marcas, descripcion_marcas) FROM stdin;
1	SIN ESPECIFICAR
2	DE EXPORTACION
\.


--
-- Data for Name: order; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public."order" (id_order, id_contacto, numero_order, fecha_expedicion, idcondicion_pago, estado_order) FROM stdin;
1	1	7683	2025-04-29	1	PENDIENTE
3	2	9046	2025-05-01	1	PENDIENTE
4	2	1118	2025-05-01	1	PENDIENTE
5	2	7915	2025-05-01	1	PENDIENTE
6	1	8825	2025-05-02	1	PENDIENTE
7	2	6354	2025-05-03	1	PENDIENTE
8	2	9989	2025-05-03	1	PENDIENTE
9	2	5563	2025-05-03	1	PENDIENTE
10	2	6308	2025-05-05	1	PENDIENTE
11	1	6302	2025-05-05	1	PENDIENTE
12	2	4598	2025-05-05	1	PENDIENTE
13	2	4598	2025-05-05	1	PENDIENTE
14	2	4598	2025-05-05	1	PENDIENTE
15	1	720	2025-05-05	1	PENDIENTE
16	1	720	2025-05-05	1	PENDIENTE
17	2	477	2025-05-05	1	PENDIENTE
18	2	477	2025-05-05	1	PENDIENTE
19	2	477	2025-05-05	1	PENDIENTE
20	2	477	2025-05-05	1	PENDIENTE
21	2	7372	2025-05-05	1	PENDIENTE
22	2	7372	2025-05-05	1	PENDIENTE
23	2	7372	2025-05-05	1	PENDIENTE
24	2	7372	2025-05-05	1	PENDIENTE
25	2	7372	2025-05-05	1	PENDIENTE
26	2	7372	2025-05-05	1	PENDIENTE
27	2	7372	2025-05-05	1	PENDIENTE
28	2	7372	2025-05-05	1	PENDIENTE
29	1	7372	2025-05-05	1	PENDIENTE
30	1	7381	2025-05-05	1	PENDIENTE
31	1	5632	2025-05-05	1	PENDIENTE
32	1	223	2025-05-05	1	PENDIENTE
33	2	9716	2025-05-05	1	PENDIENTE
34	1	2612	2025-05-05	1	PENDIENTE
35	2	7652	2025-05-05	1	PENDIENTE
36	1	7883	2025-05-05	1	PENDIENTE
37	2	3023	2025-05-05	1	PENDIENTE
38	1	6349	2025-05-05	1	PENDIENTE
39	2	725	2025-05-05	1	PENDIENTE
40	2	5577	2025-05-05	1	PENDIENTE
41	2	5577	2025-05-05	1	PENDIENTE
42	2	8946	2025-05-05	1	PENDIENTE
43	2	6586	2025-05-05	1	PENDIENTE
44	2	6586	2025-05-05	1	PENDIENTE
45	1	9651	2025-05-05	1	PENDIENTE
46	1	9651	2025-05-05	1	PENDIENTE
47	1	9651	2025-05-05	1	PENDIENTE
48	1	7082	2025-05-05	1	PENDIENTE
49	1	7404	2025-05-05	1	PENDIENTE
50	2	7404	2025-05-05	1	PENDIENTE
51	2	7404	2025-05-05	1	PENDIENTE
52	2	7404	2025-05-05	1	PENDIENTE
53	2	7404	2025-05-05	1	PENDIENTE
54	2	3461	2025-05-06	1	PENDIENTE
55	1	7017	2025-05-06	1	PENDIENTE
56	2	2026	2025-05-07	1	PENDIENTE
57	1	2384	2025-05-07	1	PENDIENTE
58	1	264	2025-05-07	1	PENDIENTE
59	1	6377	2025-05-07	1	PENDIENTE
61	1	6675	2025-05-07	1	PENDIENTE
62	2	7249	2025-05-08	1	PENDIENTE
63	2	7606	2025-05-08	1	PENDIENTE
64	1	4893	2025-05-08	1	PENDIENTE
65	1	5026	2025-05-08	1	PENDIENTE
66	2	8756	2025-05-08	1	PENDIENTE
67	2	4554	2025-05-08	1	PENDIENTE
68	1	4644	2025-05-08	1	PENDIENTE
69	2	7961	2025-05-10	1	PENDIENTE
70	2	2341	2025-05-12	1	PENDIENTE
71	1	9241	2025-05-12	1	PENDIENTE
72	1	8130	2025-05-13	1	PENDIENTE
73	1	2232	2025-05-13	1	PENDIENTE
74	2	5366	2025-05-13	1	PENDIENTE
75	2	658	2025-05-13	1	PENDIENTE
76	1	7412	2025-05-16	1	PENDIENTE
78	3	1644	2025-05-17	1	PENDIENTE
77	1	6419	2025-05-17	1	FACTURADA
\.


--
-- Data for Name: order_detail; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.order_detail (id_order_detail, id_item, id_order, cantidad) FROM stdin;
1	1	1	1
2	1	3	1
3	2	4	1
4	1	4	1
5	1	5	1
6	2	5	1
7	2	6	3
8	1	6	1
9	1	7	1
10	2	7	1
11	2	8	10
12	1	8	5
13	2	9	1
14	2	9	1
15	2	9	1
16	2	10	1
17	2	11	1
18	2	12	1
19	2	13	1
20	2	14	1
21	2	15	1
22	2	16	1
23	2	17	1
24	2	18	1
25	2	19	1
26	2	20	1
27	2	21	1
28	2	22	1
29	2	23	1
30	2	24	1
31	2	25	1
32	2	26	1
33	2	27	1
34	2	28	1
35	2	29	1
36	2	30	1
37	2	31	1
38	2	32	1
39	1	33	1
40	2	34	1
41	2	35	1
42	2	36	1
43	2	37	1
44	2	38	1
45	2	38	1
46	2	39	1
47	2	40	1
48	2	41	1
49	2	42	1
50	2	43	1
51	2	44	1
52	2	45	1
53	2	46	1
54	2	47	1
55	2	48	1
56	2	49	1
57	2	50	1
58	2	51	1
59	2	52	1
60	2	53	1
61	2	54	1
62	2	54	1
63	1	54	1
64	2	55	3
65	1	55	3
66	2	56	100
67	2	57	1
68	1	57	1
69	2	58	5
70	1	58	1
71	2	59	1
72	1	59	100
73	2	61	10000
74	1	62	100
75	2	62	1
76	2	63	100
77	2	63	11
78	2	63	1
79	2	63	1
80	2	63	1
81	2	63	1
82	2	63	1
83	2	64	100
84	2	64	1
85	2	64	1
86	2	64	1
87	2	64	1
88	2	64	1
89	2	64	1
90	2	64	1
91	2	64	1
92	2	64	1
93	2	65	20
94	2	65	10
95	2	66	1
96	2	67	1
97	2	68	1
98	2	69	1
99	12	70	1
100	13	71	1
101	10	71	10
102	1	71	1
103	11	72	1
104	12	73	1
105	11	73	1
106	12	74	1
107	11	74	1
108	12	75	1
109	12	75	1
110	14	75	1
111	12	75	1
112	12	75	1
113	12	75	1
114	1	75	1
115	1	75	1
116	10	75	1
117	11	76	1
118	14	76	1
119	10	77	1000
120	12	78	10
121	1	78	120
\.


--
-- Data for Name: punto_expedicion; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.punto_expedicion (id_punto_expedicion, id_establecimiento, numero_expedicion) FROM stdin;
1	1	001
\.


--
-- Data for Name: timbrado; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.timbrado (id_timbrado, numero_autorizacion, fecha_autorizacion, fecha_inicio_vigencia, estado_timbrado, id_establecimiento, id_punto_expedicion) FROM stdin;
1	5901	2025-02-22	2025-02-22	t	1	1
\.


--
-- Name: condicion_pagos_idcondicion_pago_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.condicion_pagos_idcondicion_pago_seq', 1, true);


--
-- Name: contacto_cli_id_contacto_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.contacto_cli_id_contacto_seq', 3, true);


--
-- Name: establecimiento_id_establecimiento_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.establecimiento_id_establecimiento_seq', 1, true);


--
-- Name: factura_detalle_id_factura_detail_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.factura_detalle_id_factura_detail_seq', 29, true);


--
-- Name: item_categoria_id_categoria_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.item_categoria_id_categoria_seq', 1, true);


--
-- Name: item_id_item_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.item_id_item_seq', 15, true);


--
-- Name: item_impuesto_id_impuesto_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.item_impuesto_id_impuesto_seq', 3, true);


--
-- Name: item_marcas_id_marcas_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.item_marcas_id_marcas_seq', 2, true);


--
-- Name: order_detail_id_order_detail_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.order_detail_id_order_detail_seq', 121, true);


--
-- Name: order_id_order_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.order_id_order_seq', 78, true);


--
-- Name: punto_expedicion_id_punto_expedicion_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.punto_expedicion_id_punto_expedicion_seq', 1, true);


--
-- Name: timbrado_id_timbrado_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.timbrado_id_timbrado_seq', 1, true);


--
-- Name: condicion_pagos condicion_pagos_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.condicion_pagos
    ADD CONSTRAINT condicion_pagos_pkey PRIMARY KEY (idcondicion_pago);


--
-- Name: contacto_cli contacto_cli_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.contacto_cli
    ADD CONSTRAINT contacto_cli_pkey PRIMARY KEY (id_contacto);


--
-- Name: establecimiento establecimiento_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.establecimiento
    ADD CONSTRAINT establecimiento_pkey PRIMARY KEY (id_establecimiento);


--
-- Name: factura_detalle factura_detalle_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_detalle
    ADD CONSTRAINT factura_detalle_pkey PRIMARY KEY (id_factura_detail);


--
-- Name: factura_encabezado factura_enca_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_encabezado
    ADD CONSTRAINT factura_enca_pkey PRIMARY KEY (id_factura_enca);


--
-- Name: item_categoria item_categoria_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.item_categoria
    ADD CONSTRAINT item_categoria_pkey PRIMARY KEY (id_categoria);


--
-- Name: item_impuesto item_impuesto_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.item_impuesto
    ADD CONSTRAINT item_impuesto_pkey PRIMARY KEY (id_impuesto);


--
-- Name: item_marcas item_marcas_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.item_marcas
    ADD CONSTRAINT item_marcas_pkey PRIMARY KEY (id_marcas);


--
-- Name: item item_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.item
    ADD CONSTRAINT item_pkey PRIMARY KEY (id_item);


--
-- Name: order_detail order_detail_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.order_detail
    ADD CONSTRAINT order_detail_pkey PRIMARY KEY (id_order_detail);


--
-- Name: order order_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public."order"
    ADD CONSTRAINT order_pkey PRIMARY KEY (id_order);


--
-- Name: punto_expedicion punto_expedicion_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.punto_expedicion
    ADD CONSTRAINT punto_expedicion_pkey PRIMARY KEY (id_punto_expedicion);


--
-- Name: timbrado timbrado_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.timbrado
    ADD CONSTRAINT timbrado_pkey PRIMARY KEY (id_timbrado);


--
-- Name: fki_fk_id_item; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_fk_id_item ON public.factura_detalle USING btree (id_item);


--
-- Name: fki_fk_id_order; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX fki_fk_id_order ON public.factura_encabezado USING btree (id_order);


--
-- Name: factura_encabezado trigger_factura_actualiza_order; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trigger_factura_actualiza_order AFTER INSERT ON public.factura_encabezado FOR EACH ROW WHEN ((new.id_order IS NOT NULL)) EXECUTE FUNCTION public.actualizar_estado_order();


--
-- Name: factura_encabezado fk_id_contacto; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_encabezado
    ADD CONSTRAINT fk_id_contacto FOREIGN KEY (id_contacto) REFERENCES public.contacto_cli(id_contacto);


--
-- Name: factura_encabezado fk_id_establecimiento; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_encabezado
    ADD CONSTRAINT fk_id_establecimiento FOREIGN KEY (id_establecimiento) REFERENCES public.establecimiento(id_establecimiento);


--
-- Name: punto_expedicion fk_id_establecimiento; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.punto_expedicion
    ADD CONSTRAINT fk_id_establecimiento FOREIGN KEY (id_establecimiento) REFERENCES public.establecimiento(id_establecimiento);


--
-- Name: factura_detalle fk_id_factura_enca; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_detalle
    ADD CONSTRAINT fk_id_factura_enca FOREIGN KEY (id_factura_enca) REFERENCES public.factura_encabezado(id_factura_enca);


--
-- Name: factura_detalle fk_id_item; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_detalle
    ADD CONSTRAINT fk_id_item FOREIGN KEY (id_item) REFERENCES public.item(id_item);


--
-- Name: factura_encabezado fk_id_order; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_encabezado
    ADD CONSTRAINT fk_id_order FOREIGN KEY (id_order) REFERENCES public."order"(id_order);


--
-- Name: factura_encabezado fk_id_punto_expedicion; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_encabezado
    ADD CONSTRAINT fk_id_punto_expedicion FOREIGN KEY (id_punto_expedicion) REFERENCES public.punto_expedicion(id_punto_expedicion);


--
-- Name: factura_encabezado fk_id_timbrado; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_encabezado
    ADD CONSTRAINT fk_id_timbrado FOREIGN KEY (id_timbrado) REFERENCES public.timbrado(id_timbrado);


--
-- Name: factura_encabezado fk_idcondicion_pago; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.factura_encabezado
    ADD CONSTRAINT fk_idcondicion_pago FOREIGN KEY (idcondicion_pago) REFERENCES public.condicion_pagos(idcondicion_pago);


--
-- Name: order fk_idcondicion_pago; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public."order"
    ADD CONSTRAINT fk_idcondicion_pago FOREIGN KEY (idcondicion_pago) REFERENCES public.condicion_pagos(idcondicion_pago);


--
-- Name: timbrado fk_timbrado_establecimiento; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.timbrado
    ADD CONSTRAINT fk_timbrado_establecimiento FOREIGN KEY (id_establecimiento) REFERENCES public.establecimiento(id_establecimiento);


--
-- Name: timbrado fk_timbrado_punto_expedicion; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.timbrado
    ADD CONSTRAINT fk_timbrado_punto_expedicion FOREIGN KEY (id_punto_expedicion) REFERENCES public.punto_expedicion(id_punto_expedicion);


--
-- Name: item item_id_categoria_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.item
    ADD CONSTRAINT item_id_categoria_fkey FOREIGN KEY (id_categoria) REFERENCES public.item_categoria(id_categoria);


--
-- Name: item item_id_impuesto_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.item
    ADD CONSTRAINT item_id_impuesto_fkey FOREIGN KEY (id_impuesto) REFERENCES public.item_impuesto(id_impuesto);


--
-- Name: item item_id_marcas_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.item
    ADD CONSTRAINT item_id_marcas_fkey FOREIGN KEY (id_marcas) REFERENCES public.item_marcas(id_marcas);


--
-- Name: order_detail order_detail_id_item_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.order_detail
    ADD CONSTRAINT order_detail_id_item_fkey FOREIGN KEY (id_item) REFERENCES public.item(id_item);


--
-- Name: order_detail order_detail_id_order_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.order_detail
    ADD CONSTRAINT order_detail_id_order_fkey FOREIGN KEY (id_order) REFERENCES public."order"(id_order);


--
-- Name: order order_id_contacto_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public."order"
    ADD CONSTRAINT order_id_contacto_fkey FOREIGN KEY (id_contacto) REFERENCES public.contacto_cli(id_contacto);


--
-- PostgreSQL database dump complete
--

